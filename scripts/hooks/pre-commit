#!/bin/sh
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#  Git Pre-commit Hook - Prince Baby App
#  ุงูุชุญูู ุงูุชููุงุฆู ูู ุตุญุฉ ุงูุจูุงูุงุช ูุจู ูู commit
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo ""
echo "๐ ุฌุงุฑู ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช Git Storage..."
echo ""

# ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ูููุงุช data_storage ูุฏ ุชุบูุฑุช
CHANGED_DATA=$(git diff --cached --name-only -- 'data_storage/')

if [ -z "$CHANGED_DATA" ]; then
    echo "โน๏ธ  ูุง ุชูุฌุฏ ุชุบููุฑุงุช ูู data_storage/ - ุชุฎุทู ุงููุญุต"
    exit 0
fi

echo "๐ ุงููููุงุช ุงููุชุบูุฑุฉ ูู data_storage/:"
echo "$CHANGED_DATA"
echo ""

# ุชุดุบูู ุณูุฑูุจุช ุงูุชุญูู
dart run scripts/validate_data.dart

if [ $? -ne 0 ]; then
    echo ""
    echo "โ ูุดู ุงูุชุญูู ูู ุงูุจูุงูุงุช! ูุฑุฌู ุฅุตูุงุญ ุงูุฃุฎุทุงุก ูุจู ุนูู commit."
    echo "   ููููู ุชุฌุงูุฒ ูุฐุง ุงููุญุต ุจุงุณุชุฎุฏุงู: git commit --no-verify"
    echo ""
    exit 1
fi

echo ""
echo "โ ุชู ุงูุชุญูู ุจูุฌุงุญ. ูุชุงุจุนุฉ ุนูููุฉ ุงูู commit..."
echo ""
exit 0
